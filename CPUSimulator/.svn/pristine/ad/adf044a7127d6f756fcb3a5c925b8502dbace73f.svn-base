package edu.gwu.frame;

import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.Observable;
import java.util.Observer;

import javax.swing.Box;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.TitledBorder;

import edu.gwu.core.CPU;

public class MainFrame extends JFrame implements Observer{

	/**
	 * 
	 */
	private static final long serialVersionUID = 9058808062307751300L;
	
	
	private JPanel codeLoaderPanel;
	
	private JPanel actionPanel;
	
	private ConsolePanel consolePanel;
	
	private RegisterPanel registerPanel;
	private MemoryPanel memoryPanel;
	
	private JButton reset,run,runSingleStep;
	
	public MainFrame(){
		super("CPU Simulator");
		
		this.setSize(640,636);
		this.setLocation(200, 120);
		
		this.setLayout(null);
		
		codeLoaderPanel = new CodeLoader();
		codeLoaderPanel.setBounds(5, 0, 480, 200);
		this.add(codeLoaderPanel);
		
		consolePanel = new ConsolePanel();
		consolePanel.setBounds(5, 205, 360, 200);
		
		actionPanel = new JPanel();
		actionPanel.setBorder(new TitledBorder("Action"));
		Box box = Box.createVerticalBox();
		reset = new JButton("Reset");
		run = new JButton("run");
		box.add(reset);
		reset.setVisible(false);
		
		runSingleStep = new JButton("Run Sinlge Step");
		
		
		box.add(run);
		box.add(runSingleStep);
		actionPanel.add(box);
		actionPanel.setBounds(490, 0, 145, 200);
		this.add(actionPanel);
		
		this.add(consolePanel);
		
		registerPanel = new RegisterPanel();
		registerPanel.setBounds(5, 410, 360, 200);
		this.add(registerPanel);
		
		memoryPanel = new MemoryPanel();
		memoryPanel.setBounds(375, 205, 260, 405);
		this.add(memoryPanel);
		
		this.setVisible(true);
		//this.pack();
		this.setResizable(false);
		this.addListener();
		
	}
	
	private void addListener(){
		run.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						CPU.getInstance().execute();
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
		
		runSingleStep.addMouseListener(
				new MouseListener(){

					@Override
					public void mouseClicked(MouseEvent e) {
						CPU.getInstance().executeSingleStep();
					}

					@Override
					public void mousePressed(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseReleased(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseEntered(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}

					@Override
					public void mouseExited(MouseEvent e) {
						// TODO Auto-generated method stub
						
					}
					
				});
	}
	
	public static void main(String[] args){
		MainFrame frame = new MainFrame();
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

		Log log = Log.getInstance();
		log.addObserver(frame);
		
		
	}

	@Override
	public void update(Observable o, Object arg) {
		consolePanel.update();
		memoryPanel.update();
		registerPanel.update();
	}
}
